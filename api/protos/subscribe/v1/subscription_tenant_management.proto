syntax = "proto3";

package api.subscription.v1;

option go_package = "subscribe/v1;v1";

import "google/protobuf/duration.proto";
import "google/protobuf/timestamp.proto";
import "subscribe/v1/subscription_management.proto";

// SubscriptionTenantManagementService 订阅服务内部接口
service SubscriptionTenantManagementService {
  // CreateSubscription 商户创建订阅
  rpc CreateSubscription(CreateSubscriptionRequest) returns (CreateSubscriptionResponse);
  // ReNewSubscription 商户续订订阅
  rpc ReNewSubscription(ReNewSubscriptionRequest) returns (ReNewSubscriptionResponse);
  // UpgradeSubscription 商户升级订阅
  rpc UpgradeSubscription(UpgradeSubscriptionRequest) returns (UpgradeSubscriptionResponse);
}

// 创建订阅请求
message CreateSubscriptionRequest {
  string product_code = 1 [json_name = "productCode"];                       // 产品Code
  string plan_code = 2 [json_name = "planCode"];                             // 套餐Code
  bool automatic_renewal = 3 [json_name = "automaticRenewal"];               // 是否自动续费
  google.protobuf.Timestamp start_date = 4 [json_name = "startDate"];        // 订阅开始时间
  optional google.protobuf.Timestamp end_date = 5 [json_name = "endDate"];   // 订阅结束时间
  bool is_trial = 6 [json_name = "isTrial"];                                 // 是否试用期
  SubscriptionOrderInfo order = 7 [json_name = "order"];                     // 订单信息
}

// 创建订阅回复
message CreateSubscriptionResponse {
  SubscriptionInfo subscription = 1 [json_name = "subscription"];            // 订阅信息
}

// 续定订阅请求
message ReNewSubscriptionRequest {
  string subscription_code = 1 [json_name = "subscriptionCode"];             // 订阅Code
  string product_code = 2 [json_name = "productCode"];                       // 产品Code
  string plan_code = 3 [json_name = "planCode"];                             // 套餐Code
  google.protobuf.Duration re_new_time = 4 [json_name = "reNewTime"];        // 续费时长
  SubscriptionOrderInfo order = 5 [json_name = "order"];                     // 订单信息
}

// 续定订阅回复
message ReNewSubscriptionResponse {
  SubscriptionInfo subscription = 1 [json_name = "subscription"];            // 订阅信息
}

// 升级订阅请求
message UpgradeSubscriptionRequest{
  string subscription_code = 1 [json_name = "subscriptionCode"];             // 订阅Code
  string product_code = 2 [json_name = "productCode"];                       // 产品Code
  string plan_code = 3 [json_name = "planCode"];                             // 套餐Code
  google.protobuf.Timestamp start_date = 4 [json_name = "startDate"];        // 订阅开始时间
  optional google.protobuf.Timestamp end_date = 5 [json_name = "endDate"];   // 订阅结束时间
  SubscriptionOrderInfo order = 6 [json_name = "order"];                     // 订单信息
}


// 升级订阅回复
message UpgradeSubscriptionResponse {
  SubscriptionInfo subscription = 1 [json_name = "subscription"];            // 订阅信息
}