syntax = "proto3";

package api.product.v1;

option go_package = "product/v1;v1";

import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";

// 定价规则管理服务
service PricingRuleManagementService {
  // 获取定价规则列表
  rpc ListPricingRules(ListPricingRulesRequest)returns (ListPricingRulesResponse);
}

// 规则类型枚举
enum RuleType {
  RULE_TYPE_UNSPECIFIED = 0;
  NUMERIC = 1;       // 数字型
  USAGE = 2;         // 用量型
  SWITCH = 3;        // 开关型
}

// 规则状态枚举
enum RuleStatus {
  RULE_STATUS_UNSPECIFIED = 0;
  RULE_ACTIVE = 1;   // 启用
  RULE_INACTIVE = 2; // 禁用
}

// 重置周期枚举
enum ResetPeriod {
  RESET_PERIOD_UNSPECIFIED = 0;
  NONE = 1;          // 不重置
  DAILY = 2;         // 每日
  WEEKLY = 3;        // 每周
  MONTHLY = 4;       // 每月
  YEARLY = 5;        // 每年
}

// 定价规则信息
message PricingRuleInfo {
  uint32 id = 1 [json_name = "id"];                                       // 规则ID
  string rule_key = 2 [json_name = "ruleKey"];                            // 规则键名
  google.protobuf.Struct i18n = 3 [json_name = "i18n"];                   // 多语言内容
  RuleType rule_type = 4 [json_name = "ruleType"];                        // 规则类型
  optional string unit = 5 [json_name = "unit"];                          // 单位
  repeated string checkpoints = 6 [json_name = "checkpoints"];            // 检查点列表
  bool is_visible = 7 [json_name = "isVisible"];                          // 是否显示在前端
  bool is_accumulative = 8 [json_name = "isAccumulative"];                // 是否累加计算
  bool is_reset_periodically = 9 [json_name = "isResetPeriodically"];    // 是否按周期重置
  ResetPeriod reset_period = 10 [json_name = "resetPeriod"];              // 重置周期
  RuleStatus status = 12 [json_name = "status"];                          // 状态
  int32 sort_order = 13 [json_name = "sortOrder"];                        // 排序顺序
  int32 usage_count = 14 [json_name = "usageCount"];                      // 使用次数
  google.protobuf.Timestamp create_time = 15 [json_name = "createTime"];  // 创建时间
  google.protobuf.Timestamp update_time = 16 [json_name = "updateTime"];  // 更新时间
  bool allow_unlimited = 17 [json_name = "allowUnlimited"];                          // 是否允许不限
}

// 获取定价规则列表请求
message ListPricingRulesRequest {
  optional int32 page = 1 [json_name = "page"];                           // 页码
  optional int32 page_size = 2 [json_name = "pageSize"];                  // 每页数量
  optional string search = 3 [json_name = "search"];                      // 关键词搜索
  optional RuleType rule_type = 4 [json_name = "ruleType"];               // 规则类型筛选
  optional RuleStatus status = 5 [json_name = "status"];                  // 状态筛选
  optional bool is_visible = 6 [json_name = "isVisible"];                 // 是否可见筛选
}

message ListPricingRulesResponse {
  repeated PricingRuleInfo rules = 1 [json_name = "rules"];               // 规则列表
  int32 total = 2 [json_name = "total"];                                  // 总数
  int32 page = 3 [json_name = "page"];                                    // 当前页码
  int32 page_size = 4 [json_name = "pageSize"];
  string message = 5 [json_name = "message"];
  bool success = 6 [json_name = "success"];
}